{
  "version": "2.2.0",
  "summary": {
    "title": "Mini Zanzibar",
    "owner": "",
    "description": "",
    "id": 0
  },
  "detail": {
    "contributors": [],
    "diagrams": [
      {
        "id": 1,
        "title": "Mini Zanzibar Stride",
        "diagramType": "STRIDE",
        "placeholder": "New STRIDE diagram description",
        "thumbnail": "./public/content/images/thumbnail.stride.jpg",
        "version": "2.2.0",
        "cells": [
          {
            "shape": "trust-boundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "id": "1cf9e44a-889b-4565-b5b5-4eb1d01ae398",
            "source": {
              "x": 330,
              "y": 20
            },
            "target": {
              "x": 280,
              "y": 210
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "827916d8-edb1-4d32-99ae-17112c5f19ac",
            "source": {
              "cell": "7aa42948-310f-4ceb-b29b-6be913c7ae4d"
            },
            "target": {
              "x": 200,
              "y": 120
            },
            "vertices": [
              {
                "x": 340,
                "y": 165
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "b74b305c-04d4-426a-8f7f-390a9b816a69",
            "source": {
              "cell": "38c08a99-8bc1-4b46-8d23-8747f350625e"
            },
            "target": {
              "cell": "7aa42948-310f-4ceb-b29b-6be913c7ae4d"
            },
            "vertices": [
              {
                "x": 450,
                "y": 90
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "a365f73f-c3d4-4b41-8cee-454c1bd98bbb",
            "source": {
              "cell": "7aa42948-310f-4ceb-b29b-6be913c7ae4d"
            },
            "target": {
              "cell": "4850cb23-4ca4-4c12-afb4-67a903ba0f52"
            },
            "vertices": [
              {
                "x": 620,
                "y": 220
              },
              {
                "x": 640,
                "y": 320
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "ad8fcd12-be3f-4c9a-ae2e-439345b8c560",
            "source": {
              "cell": "7aa42948-310f-4ceb-b29b-6be913c7ae4d"
            },
            "target": {
              "cell": "2de02480-a0a9-44b2-b4bb-e4a15bf82757"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "423ebf06-1f3e-4ac0-96cc-0fdf2d081e47",
            "source": {
              "cell": "4850cb23-4ca4-4c12-afb4-67a903ba0f52"
            },
            "target": {
              "cell": "7aa42948-310f-4ceb-b29b-6be913c7ae4d"
            },
            "vertices": [
              {
                "x": 542.5,
                "y": 240
              }
            ]
          },
          {
            "shape": "trust-boundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "id": "3e07ea4e-2177-4002-9b2f-c2ed5c240c04",
            "source": {
              "x": 430,
              "y": 260
            },
            "target": {
              "x": 763,
              "y": 354
            },
            "vertices": [
              {
                "x": 580,
                "y": 260
              },
              {
                "x": 740,
                "y": 320
              }
            ]
          },
          {
            "shape": "trust-boundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "id": "685fd659-b71b-4c8f-b0d8-f45a3d7cae35",
            "source": {
              "x": 960,
              "y": 90
            },
            "target": {
              "x": 806,
              "y": 320
            }
          },
          {
            "position": {
              "x": 150,
              "y": 60.00000000000003
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "User"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 11,
            "id": "38c08a99-8bc1-4b46-8d23-8747f350625e",
            "data": {
              "type": "tm.Actor",
              "name": "User",
              "description": "Frontend",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "providesAuthentication": false,
              "threats": [
                {
                  "id": "710d37ff-0bc0-4fdf-9710-940400b033a2",
                  "title": "Malicious request",
                  "status": "Open",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "An attacker can impersonate a User and send malicious requests.",
                  "mitigation": "Implement strong user authentication and access control to reduce opportunities for impersonation and privilege escalation.\nImplement detailed logging and auditing to enable monitoring and verification of user actions.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 9,
                  "score": ""
                }
              ]
            }
          },
          {
            "position": {
              "x": 532.5,
              "y": 100
            },
            "size": {
              "width": 120,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Web Server"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 12,
            "id": "7aa42948-310f-4ceb-b29b-6be913c7ae4d",
            "data": {
              "type": "tm.Process",
              "name": "Web Server",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "4057d71b-bd7f-4d6e-9fe6-51ba15a09252",
                  "title": "Transit data attack threat",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "(Web Post Request (HTTP), HTTP Response) between the user and the web server can be modified if it is not encrypted. An attacker can intercept and modify data in transit.",
                  "mitigation": "Ensure that all data in transit is encrypted using TLS.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 13,
                  "score": ""
                },
                {
                  "id": "52842057-bf43-4384-9a80-d4932851d14e",
                  "title": "Inadequate Logging and Auditing",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "The Web Server should have appropriate logging and auditing to prevent denial of actions by users or attackers. The lack of these mechanisms allows users or attackers to deny their activities.",
                  "mitigation": "Implement detailed logging and auditing to enable monitoring and verification of user actions.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 14,
                  "score": ""
                },
                {
                  "id": "b6a1f3d7-615d-46f1-85f6-ef0ed42294a6",
                  "title": "Unencrypted Data Transmission",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "Data Flow can reveal sensitive information if communication is not encrypted. Attackers can eavesdrop on traffic between users and web servers.",
                  "mitigation": "Ensure that all data in transit is encrypted using TLS.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 15,
                  "score": ""
                },
                {
                  "id": "348ed95d-b431-4450-bbb4-066228924803",
                  "title": "Denial of Service (DoS) Attack",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "Web Server can be the target of a DoS attack, where attackers can flood the server with requests, thereby denying legitimate access to users.",
                  "mitigation": "Traffic Management: Use load balancers and rate limiters to manage incoming traffic and mitigate the impact of volumetric attacks.\nNetwork Security: Deploy firewalls and intrusion detection/prevention systems (IDPS) to filter out malicious traffic.\nResource Scaling: Scale infrastructure resources (such as servers and bandwidth) to handle sudden spikes in traffic.\nDDoS Protection Services: Consider using specialized DDoS protection services that can detect and mitigate attacks in real-time.\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 17,
                  "score": ""
                },
                {
                  "id": "ae0767ee-997f-47b8-84f6-3fc8958dc924",
                  "title": "Privilege Escalation Attack on Web Server",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "Attackers target the Web Server with the goal of escalating their privileges, gaining access to resources and capabilities beyond their authorized permissions.",
                  "mitigation": "Assign minimal privileges necessary for users and processes to perform their functions, reducing the impact of potential privilege escalation.\n Keep software and applications on the Web Server up to date with security patches to mitigate known vulnerabilities.\nMonitor server activities, log access attempts, and set up alerts for suspicious activities or unauthorized privilege escalations.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 19,
                  "score": ""
                }
              ]
            }
          },
          {
            "position": {
              "x": 482.5,
              "y": 390
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Level DB"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 13,
            "id": "4850cb23-4ca4-4c12-afb4-67a903ba0f52",
            "data": {
              "type": "tm.Store",
              "name": "Level DB",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "id": "031d784a-f287-4529-a8bd-a180e5f70f78",
                  "title": "Data Disclosure",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "Data can be exposed if it is not adequately protected.",
                  "mitigation": "Implement robust access controls and authentication mechanisms to restrict access to sensitive data.\nEncrypt sensitive information both at rest (stored data) and in transit (data being transmitted).\nRegularly audit and monitor access to sensitive data to detect unauthorized access or anomalies.\nTrain employees and users on data protection best practices and awareness.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 16,
                  "score": ""
                },
                {
                  "id": "0a6db040-bdc1-429d-b4a0-3217b08e6b5c",
                  "title": "Resource Exhaustion Attack on LevelDB",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "Level DB can be the target of attacks that can exhaust database resources, thus slowing down or preventing access to data.",
                  "mitigation": " Implement controls to limit the rate of requests or queries to LevelDB, preventing overload from excessive traffic.\nSet up monitoring systems to detect unusual spikes in database activity or resource consumption, triggering alerts for timely intervention.\nOptimize LevelDB configurations and performance parameters to handle peak loads more efficiently and resist resource exhaustion attempts.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 18,
                  "score": ""
                }
              ]
            }
          },
          {
            "position": {
              "x": 370,
              "y": 40
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Web Post Request (HTTP)"
              }
            },
            "visible": true,
            "shape": "td-text-block",
            "zIndex": 15,
            "id": "f88aacec-6154-441e-89f5-7dcec1807c50",
            "data": {
              "type": "tm.Text",
              "name": "Web Post Request (HTTP)",
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 920,
              "y": 220
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Consul"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 16,
            "id": "2de02480-a0a9-44b2-b4bb-e4a15bf82757",
            "data": {
              "type": "tm.Store",
              "name": "Consul",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "id": "05b5a96c-2dae-48fd-9a55-baeedcc13eb1",
                  "title": "Security Risks to Consul",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "Attackers may attempt to modify or tamper with data stored in Consul, such as service configurations or key-value pairs, leading to operational disruptions or unauthorized access.",
                  "mitigation": "Configure strict access controls and authentication mechanisms for Consul APIs and user interfaces to prevent unauthorized access.\nEncrypt data stored in Consul to protect it from unauthorized disclosure or tampering.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 20,
                  "score": ""
                },
                {
                  "id": "49732129-e507-4b98-9c11-90bdf33a5656",
                  "title": "Security Risks to Consul [Information disclosure]",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": " Vulnerabilities in Consul could potentially expose sensitive information, such as credentials or configuration details, to unauthorized parties.",
                  "mitigation": " Conduct regular security audits and vulnerability assessments of Consul configurations and deployments.\n Encrypt data stored in Consul to protect it from unauthorized disclosure or tampering.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 21,
                  "score": ""
                }
              ]
            }
          },
          {
            "position": {
              "x": 342,
              "y": 120.00000000000003
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "HTTP Response"
              }
            },
            "visible": true,
            "shape": "td-text-block",
            "zIndex": 17,
            "id": "c48e6168-3fdb-477f-a31e-cf0db8e0ba35",
            "data": {
              "type": "tm.Text",
              "name": "HTTP Response",
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 420,
              "y": 290
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "ACL Data Read"
              }
            },
            "visible": true,
            "shape": "td-text-block",
            "zIndex": 18,
            "id": "709ea586-70a1-4f50-b658-cad134e53e4f",
            "data": {
              "type": "tm.Text",
              "name": "ACL Data Read",
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 550,
              "y": 280
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "ACL Data Write"
              }
            },
            "visible": true,
            "shape": "td-text-block",
            "zIndex": 19,
            "id": "ff83726c-cf4b-414a-b308-f50200f9efc9",
            "data": {
              "type": "tm.Text",
              "name": "ACL Data Write",
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 720,
              "y": 140
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Namespace Data Write"
              }
            },
            "visible": true,
            "shape": "td-text-block",
            "zIndex": 20,
            "id": "572d99ab-00e4-4aca-af0f-6992ef5ec11b",
            "data": {
              "type": "tm.Text",
              "name": "Namespace Data Write",
              "hasOpenThreats": false
            }
          }
        ],
        "description": "Threat Model for Mini Zanzibar"
      }
    ],
    "diagramTop": 2,
    "reviewer": "",
    "threatTop": 21
  }
}